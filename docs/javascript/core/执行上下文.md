# 执行上下文

## 执行上下文

JavaScript 执行上下文是 JavaScript 代码执行时的环境。它包含了变量、函数、作用域链等信息。执行上下文可以分为三种类型：

1. **全局执行上下文：**这是默认的、最外层的执行上下文。在浏览器中，全局执行上下文是 window 对象。
2. **函数执行上下文：**每次函数调用时，都会为该函数创建一个新的执行上下文。
3. **eval 执行上下文：**使用 eval() 函数时也会创建一个执行上下文。

每个执行上下文都有两个阶段：**创建阶段**和**执行阶段**。

在创建阶段，会进行以下操作：

- 创建变量对象（Variable Object，VO），其中包含变量、函数声明和函数的形参。在函数上下文中，变量对象被称为活动对象（Activation Object，AO）。
- 建立作用域链（Scope Chain）。
- 确定 this 的指向。

然后进入执行阶段，代码会逐行执行，完成变量赋值、函数引用等操作。

## 执行上下文栈

执行上下文栈（Execution Context Stack，ECS）用于管理执行上下文。栈底是全局执行上下文，栈顶是当前正在执行的函数执行上下文。

当函数执行完毕，其执行上下文会从栈中弹出，控制权交还给之前的执行上下文。

